<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mis Proyectos</title>

  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <aside class="sidebar">
    <div class="photo-container">
      <img src="1.png" alt="Foto de perfil" class="profile-photo" />
    </div>
    <nav class="links">
      <a
        href="index.html"
        class="btn"
        target="_blank"
        rel="noopener noreferrer"
        >Página web</a
      >
      <a
        href="https://wa.me/573108195437"
        class="btn"
        target="_blank"
        rel="noopener noreferrer"
        >WhatsApp</a
      >
      <a
        href="https://linkedin.com/in/nalejob"
        class="btn"
        target="_blank"
        rel="noopener noreferrer"
        >LinkedIn</a
      >
    </nav>
  </aside>

  <main class="main-content">
    <h1>Mis Proyectos</h1>

    <div class="filter-container">
      <div>
        <label for="project-select">Nombre del proyecto</label>
        <select id="project-select">
          <option value="">— Selecciona —</option>
        </select>
      </div>
      <div>
        <label for="year-select">Año</label>
        <select id="year-select">
          <option value="">— Selecciona —</option>
        </select>
      </div>
    </div>

    <div class="project-detail">
      <div class="detail-box">
        <h2>Contexto Caso de Uso</h2>
        <p id="detail-context"></p>
      </div>
      <div class="detail-box">
        <h2>Problema</h2>
        <p id="detail-problema"></p>
      </div>
      <div class="detail-box">
        <h2>Herramientas</h2>
        <p id="detail-herramientas"></p>
      </div>
      <div class="detail-box">
        <h2>Habilidades</h2>
        <p id="detail-habilidades"></p>
      </div>
      <div class="detail-box">
        <h2>Resultados</h2>
        <p id="detail-resultados"></p>
      </div>
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      fetch('DetallePortafolio.json')
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP ${response.status} – ${response.statusText}`);
          }
          return response.json();
        })
        .then(proyectos => {
          const selP = document.getElementById('project-select');
          const selY = document.getElementById('year-select');

          // Llenar filtros
          const nombres = [...new Set(proyectos.map(x => x.Proyecto))].sort();
          const años = [...new Set(proyectos.map(x => x['Año']))].sort(
            (a, b) => b - a
          );
          nombres.forEach(n => selP.add(new Option(n, n)));
          años.forEach(y => selY.add(new Option(y, y)));

          selP.addEventListener('change', filtrar);
          selY.addEventListener('change', filtrar);

          function filtrar() {
            const name = selP.value;
            const year = selY.value;
            const match = proyectos.find(
              p => p.Proyecto === name && String(p['Año']) === year
            );

            if (!match) {
              document.getElementById('detail-context').innerText =
                'Selecciona un proyecto…';
              ['detail-problema', 'detail-herramientas', 'detail-habilidades', 'detail-resultados'].forEach(
                id => (document.getElementById(id).innerText = '')
              );
              return;
            }

            document.getElementById(
              'detail-context'
            ).innerText = match['Contexto Caso de Uso'] || '';
            document.getElementById('detail-problema').innerText =
              match['Problema'] || '';
            document.getElementById('detail-herramientas').innerText =
              match['Herramientas'] || '';
            document.getElementById('detail-habilidades').innerText =
              match['Habilidades'] || '';
            document.getElementById('detail-resultados').innerText =
              match['Resultados'] || '';
          }
        })
        .catch(err => {
          console.error('Error cargando datos de proyectos:', err);
          document.querySelector(
            '.main-content'
          ).innerHTML = `<p style="color:red;">
            No se pudo cargar la lista de proyectos.
          </p>`;
        });
    });
  </script>
</body>
</html>
